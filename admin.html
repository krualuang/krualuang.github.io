<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Admin â€” à¹€à¸„à¸£à¸·à¹ˆà¸­à¸‡à¸¡à¸·à¸­à¸ªà¸£à¹‰à¸²à¸‡à¹€à¸¡à¸™à¸¹à¸­à¸±à¸•à¹‚à¸™à¸¡à¸±à¸•à¸´ | à¸„à¸£à¸±à¸§à¸«à¸¥à¸§à¸‡</title>
<link href="https://fonts.googleapis.com/css2?family=Prompt:wght@400;600&display=swap" rel="stylesheet">
<style>
Â  body{font-family:'Prompt',sans-serif;margin:0;background:#f6f6f6;color:#222}
Â  header{background:#b8860b;color:#fff;padding:12px 20px;display:flex;justify-content:space-between;align-items:center}
Â  header h1{margin:0;font-size:1.1rem}
Â  .container{max-width:980px;margin:28px auto;padding:22px;background:#fff;border-radius:10px;box-shadow:0 6px 20px rgba(0,0,0,0.05)}
Â  .row{display:flex;gap:12px;flex-wrap:wrap}
Â  .col{flex:1;min-width:220px}
Â  label{display:block;font-weight:600;margin-bottom:6px}
Â  input[type=text],input[type=number],textarea{width:100%;padding:10px;border:1px solid #ddd;border-radius:8px}
Â  button{background:#b8860b;color:#fff;border:none;padding:10px 14px;border-radius:8px;cursor:pointer}
Â  .menu-list{margin-top:18px}
Â  .menu-item{padding:12px;border-radius:8px;border:1px solid #eee;background:#fafafa;margin-bottom:10px;display:flex;gap:12px;align-items:flex-start}
Â  .menu-item img{width:96px;height:72px;object-fit:cover;border-radius:6px}
Â  .small{font-size:0.9rem;color:#666}
Â  .controls{display:flex;gap:8px;flex-wrap:wrap}
Â  .danger{background:#a00}
Â  .note{font-size:0.9rem;color:#555;margin-top:8px}
Â  .login-box{max-width:360px;margin:36px auto;padding:20px;background:#fff;border-radius:10px;box-shadow:0 6px 20px rgba(0,0,0,0.05)}
</style>
</head>
<body>

<header>
Â  <h1>à¹€à¸„à¸£à¸·à¹ˆà¸­à¸‡à¸¡à¸·à¸­à¸ªà¸£à¹‰à¸²à¸‡à¹€à¸¡à¸™à¸¹à¸­à¸±à¸•à¹‚à¸™à¸¡à¸±à¸•à¸´ â€” Admin</h1>
Â  <a href="index.html" style="color:#fff;text-decoration:none;font-weight:600">â† à¸”à¸¹à¸«à¸™à¹‰à¸²à¹€à¸§à¹‡à¸šà¸«à¸¥à¸±à¸</a>
</header>

<div id="loginWrap" class="login-box">
Â  <h3>à¹€à¸‚à¹‰à¸²à¸ªà¸¹à¹ˆà¸£à¸°à¸šà¸šà¸œà¸¹à¹‰à¸”à¸¹à¹à¸¥ (PIN 4 à¸«à¸¥à¸±à¸)</h3>
Â  <div style="margin-top:8px">
Â  Â  <label for="pin">PIN</label>
Â  Â  <input id="pin" type="text" placeholder="à¸à¸£à¸­à¸ 4 à¸«à¸¥à¸±à¸">
Â  Â  <div style="margin-top:10px;display:flex;gap:8px">
Â  Â  Â  <button id="btnLogin">à¹€à¸‚à¹‰à¸²à¸ªà¸¹à¹ˆà¸£à¸°à¸šà¸š</button>
Â  Â  Â  <button id="btnUseDemo" style="background:#777">à¸—à¸”à¸¥à¸­à¸‡ (à¹„à¸¡à¹ˆà¸¡à¸µà¸¥à¹‡à¸­à¸à¸­à¸´à¸™)</button>
Â  Â  </div>
Â  Â  <p class="note">à¸„à¹ˆà¸² PIN à¹€à¸£à¸´à¹ˆà¸¡à¸•à¹‰à¸™à¸„à¸·à¸­ <strong>1234</strong> (à¹€à¸›à¸¥à¸µà¹ˆà¸¢à¸™à¹„à¸”à¹‰à¹ƒà¸™à¸ªà¸„à¸£à¸´à¸›à¸•à¹Œ)</p>
Â  </div>
</div>

<div id="adminUI" class="container" style="display:none">

Â  <h2>à¸ˆà¸±à¸”à¸à¸²à¸£à¹€à¸¡à¸™à¸¹</h2>

Â  Â  <div class="row">
Â  Â  <div class="col">
Â  Â  Â  <label for="menuName">à¸Šà¸·à¹ˆà¸­à¹€à¸¡à¸™à¸¹</label>
Â  Â  Â  <input id="menuName" type="text" placeholder="à¹€à¸Šà¹ˆà¸™ à¸œà¸±à¸”à¹„à¸—à¸¢à¸à¸¸à¹‰à¸‡à¸ªà¸”">
Â  Â  </div>

Â  Â  <div class="col">
Â  Â  Â  <label for="menuPrice">à¸£à¸²à¸„à¸² (à¸šà¸²à¸—)</label>
Â  Â  Â  <input id="menuPrice" type="number" placeholder="120">
Â  Â  Â  <span class="small">à¸ªà¸³à¸«à¸£à¸±à¸šà¹ƒà¸Šà¹‰à¸à¸±à¸šà¸£à¸²à¸¢à¸à¸²à¸£à¹€à¸¡à¸™à¸¹à¸›à¸±à¸ˆà¸ˆà¸¸à¸šà¸±à¸™</span>
Â  Â  </div>

Â  Â  <div style="flex:1 1 100%">
Â  Â  Â  <label for="menuDesc">à¸„à¸³à¸­à¸˜à¸´à¸šà¸²à¸¢</label>
Â  Â  Â  <textarea id="menuDesc" rows="3" placeholder="à¸£à¸²à¸¢à¸¥à¸°à¹€à¸­à¸µà¸¢à¸”à¹€à¸¡à¸™à¸¹"></textarea>
Â  Â  </div>

Â  Â  <div class="col">
Â  Â  Â  <label for="menuImage">à¸£à¸¹à¸›à¸ à¸²à¸ (URL) â€” à¸«à¸£à¸·à¸­à¸§à¸²à¸‡à¸§à¹ˆà¸²à¸‡à¹„à¸§à¹‰à¹€à¸à¸·à¹ˆà¸­à¹„à¸¡à¹ˆà¹ƒà¸Šà¹‰à¸£à¸¹à¸›</label>
Â  Â  Â  <input id="menuImage" type="text" placeholder="images/menu/menu_pad_thai.jpg">
Â  Â  </div>

Â  Â  <div style="display:flex;gap:8px;align-items:center">
Â  Â  Â  <button id="addBtn">à¹€à¸à¸´à¹ˆà¸¡/à¸šà¸±à¸™à¸—à¸¶à¸à¹€à¸¡à¸™à¸¹</button>
Â  Â  Â  <button id="clearBtn" style="background:#777">à¸¥à¹‰à¸²à¸‡à¸Ÿà¸­à¸£à¹Œà¸¡</button>
Â  Â  </div>
Â  </div>

Â  ---

Â  Â  <section id="menu-generator" style="margin-top:25px;padding-top:15px;border-top:1px dashed #ddd;">
Â  Â  <h2>ğŸ§‘â€ğŸ³ à¹€à¸„à¸£à¸·à¹ˆà¸­à¸‡à¸¡à¸·à¸­à¸ªà¸£à¹‰à¸²à¸‡à¹€à¸¡à¸™à¸¹à¹ƒà¸«à¸¡à¹ˆ (à¸à¸£à¹‰à¸­à¸¡à¹à¸›à¸¥à¸ à¸²à¸©à¸²)</h2>

Â  Â  <div class="row">
Â  Â  Â  <div class="col">
Â  Â  Â  Â  <label>à¸Šà¸·à¹ˆà¸­à¹€à¸¡à¸™à¸¹ (à¹„à¸—à¸¢):</label>
Â  Â  Â  Â  <input type="text" id="menuNameTh" placeholder="à¸œà¸±à¸”à¹„à¸—à¸¢à¸à¸¸à¹‰à¸‡à¸ªà¸”">
Â  Â  Â  </div>
Â  Â  Â  <div class="col">
Â  Â  Â  Â  <label>à¸„à¸³à¸­à¸˜à¸´à¸šà¸²à¸¢ (à¹„à¸—à¸¢):</label>
Â  Â  Â  Â  <textarea id="menuDescTh" rows="3" placeholder="à¹€à¸ªà¹‰à¸™à¸ˆà¸±à¸™à¸—à¹Œà¸œà¸±à¸”à¸à¸±à¸šà¸™à¹‰à¸³à¸‹à¸­à¸ªà¸ªà¸¹à¸•à¸£à¸à¸´à¹€à¸¨à¸©"></textarea>
Â  Â  Â  </div>
Â  Â  </div>

Â  Â  <div class="row" style="margin-top:10px;">
Â  Â  Â  <div class="col">
Â  Â  Â  Â  <label>à¸£à¸²à¸„à¸² (à¸šà¸²à¸—):</label>
Â  Â  Â  Â  <input type="number" id="menuPriceTh" placeholder="60">
Â  Â  Â  </div>
Â  Â  Â  <div class="col">
Â  Â  Â  Â  <label>à¸Šà¸·à¹ˆà¸­à¹„à¸Ÿà¸¥à¹Œà¸£à¸¹à¸›à¸ à¸²à¸:</label>
Â  Â  Â  Â  <input type="text" id="menuImageGen" placeholder="padthai.jpg">
Â  Â  Â  </div>
Â  Â  </div>
Â  Â  
Â  Â  <div style="margin-top:15px;display:flex;flex-wrap:wrap;gap:8px;align-items:center;">
Â  Â  Â  <button id="generateMenuBtn" style="background:#1e88e5;">âš™ï¸ à¸ªà¸£à¹‰à¸²à¸‡à¹€à¸¡à¸™à¸¹à¹à¸¥à¸°à¹à¸›à¸¥à¸ à¸²à¸©à¸²</button>
Â  Â  Â  <button id="copyJsonBtn" style="display:none;background:#2c974b;">ğŸ“‹ à¸„à¸±à¸”à¸¥à¸­à¸à¹‚à¸„à¹‰à¸” JSON</button>
Â  Â  </div>

Â  Â  <pre id="generatedKeys" style="background:#111;color:#0f0;padding:10px;border-radius:10px;white-space:pre-wrap;margin-top:20px;"></pre>
Â  Â  <div id="menuPreview" style="margin-top:20px;"></div>
Â  </section>

Â  ---

Â  Â  <div style="margin-top:20px;display:flex;gap:8px;flex-wrap:wrap">
Â  Â  <button id="saveLocal">ğŸ’¾ à¸šà¸±à¸™à¸—à¸¶à¸à¸­à¸±à¸•à¹‚à¸™à¸¡à¸±à¸•à¸´ (localStorage)</button>
Â  Â  <button id="downloadJson">â¬‡ï¸ à¸”à¸²à¸§à¸™à¹Œà¹‚à¸«à¸¥à¸” menu.json</button>
Â  Â  <input id="fileIn" type="file" style="display:none" accept="application/json">
Â  Â  <button id="uploadJson">â¬†ï¸ à¸™à¸³à¹€à¸‚à¹‰à¸² menu.json</button>

Â  Â  Â  Â  <div style="margin-left:auto;display:flex;align-items:center;gap:8px;">
Â  Â  Â  <input id="ghToken" type="text" placeholder="(OPTIONAL) GitHub Token" style="width:200px;padding:8px;border-radius:6px;border:1px solid #ddd">
Â  Â  Â  <button id="pushGithubBtn" style="background:#2c974b">ğŸš€ Push â†’ GitHub</button>
Â  Â  </div>
Â  </div>

Â  <p class="note">à¸«à¸¡à¸²à¸¢à¹€à¸«à¸•à¸¸: à¸«à¸²à¸à¹ƒà¸Šà¹‰à¸‡à¸²à¸™à¸šà¸™ GitHub Pages à¹‚à¸”à¸¢à¹„à¸¡à¹ˆà¸¡à¸µ backend à¸£à¸°à¸šà¸šà¸ˆà¸°à¸šà¸±à¸™à¸—à¸¶à¸à¹€à¸›à¹‡à¸™ localStorage à¹à¸¥à¸°à¹ƒà¸«à¹‰à¸”à¸²à¸§à¸™à¹Œà¹‚à¸«à¸¥à¸”à¹„à¸Ÿà¸¥à¹Œ JSON à¹€à¸à¸·à¹ˆà¸­à¸­à¸±à¸›à¹‚à¸«à¸¥à¸”à¹„à¸›à¸¢à¸±à¸‡à¸£à¸°à¸šà¸š / deploy à¸”à¹‰à¸§à¸¢à¸•à¸™à¹€à¸­à¸‡</p>

Â  <div class="menu-list" id="menuListWrap">
Â  Â  <h3>à¸£à¸²à¸¢à¸à¸²à¸£à¹€à¸¡à¸™à¸¹à¸—à¸±à¹‰à¸‡à¸«à¸¡à¸”</h3>
Â  Â  <div id="menuList"></div>
Â  </div>

</div>

<script>
/* =========================
Â  Â Config
Â  Â ========================= */
const ADMIN_PIN = '1234'; // à¹€à¸›à¸¥à¸µà¹ˆà¸¢à¸™ PIN à¸—à¸µà¹ˆà¸•à¹‰à¸­à¸‡à¸à¸²à¸£à¹„à¸”à¹‰à¸—à¸µà¹ˆà¸™à¸µà¹ˆ
const STORAGE_KEY = 'krualuang_menu_v1';
const DEFAULT_MENU = []; // à¸–à¹‰à¸²à¸•à¹‰à¸­à¸‡à¸à¸²à¸£à¸•à¸±à¸§à¸­à¸¢à¹ˆà¸²à¸‡ à¹ƒà¸«à¹‰à¹ƒà¸ªà¹ˆ object à¹ƒà¸™à¸™à¸µà¹‰

/* =========================
Â  Â Helper: localStorage
Â  Â ========================= */
function loadMenuFromLocal(){
Â  try{
Â  Â  const raw = localStorage.getItem(STORAGE_KEY);
Â  Â  return raw ? JSON.parse(raw) : DEFAULT_MENU.slice();
Â  }catch(e){ return DEFAULT_MENU.slice(); }
}
function saveMenuToLocal(arr){
Â  localStorage.setItem(STORAGE_KEY, JSON.stringify(arr, null, 2));
}

/* =========================
Â  Â Render
Â  Â ========================= */
let menu = loadMenuFromLocal();
const menuList = document.getElementById('menuList');

function render(){
Â  menuList.innerHTML = '';
Â  if(!menu.length){ menuList.innerHTML = '<p class="small">à¸¢à¸±à¸‡à¹„à¸¡à¹ˆà¸¡à¸µà¸£à¸²à¸¢à¸à¸²à¸£à¹€à¸¡à¸™à¸¹</p>'; return; }
Â  menu.forEach((it, idx) => {
Â  Â  const el = document.createElement('div');
Â  Â  el.className = 'menu-item';
Â  Â  el.innerHTML = `
Â  Â  Â  <div style="flex:1">
Â  Â  Â  Â  <strong>${escapeHtml(it.name||'')}</strong>
Â  Â  Â  Â  <div class="small">${escapeHtml(it.desc||'')}</div>
Â  Â  Â  Â  <div style="margin-top:8px">à¸£à¸²à¸„à¸²: <strong>${Number(it.price||0)} à¸šà¸²à¸—</strong></div>
Â  Â  Â  Â  <div style="margin-top:8px" class="controls">
Â  Â  Â  Â  Â  <button data-edit="${idx}">à¹à¸à¹‰à¹„à¸‚</button>
Â  Â  Â  Â  Â  <button data-delete="${idx}" class="danger" style="background:#a00">à¸¥à¸š</button>
Â  Â  Â  Â  </div>
Â  Â  Â  </div>
Â  Â  Â  ${it.image ? `<img src="${escapeAttr(it.image)}" alt="${escapeHtml(it.name)}">` : ''}
Â  Â  `;
Â  Â  menuList.appendChild(el);
Â  });
}

/* =========================
Â  Â Utilities
Â  Â ========================= */
function escapeHtml(s){ return (s||'').replaceAll('&','&amp;').replaceAll('<','&lt;').replaceAll('>','&gt;'); }
function escapeAttr(s){ return (s||'').replaceAll('"','&quot;'); }

/* =========================
Â  Â Handlers (Add / Clear / Edit / Delete)
Â  Â ========================= */
document.getElementById('addBtn').addEventListener('click', () => {
Â  const name = document.getElementById('menuName').value.trim();
Â  const desc = document.getElementById('menuDesc').value.trim();
Â  const price = document.getElementById('menuPrice').value.trim();
Â  const image = document.getElementById('menuImage').value.trim();
Â  if(!name || !price){ alert('à¸à¸£à¸¸à¸“à¸²à¸à¸£à¸­à¸à¸Šà¸·à¹ˆà¸­à¹€à¸¡à¸™à¸¹à¹à¸¥à¸°à¸£à¸²à¸„à¸²'); return; }
Â  menu.push({name, desc, price: Number(price), image});
Â  saveMenuToLocal(menu);
Â  render();
Â  clearForm();
});

document.getElementById('clearBtn').addEventListener('click', clearForm);

function clearForm(){
Â  document.getElementById('menuName').value='';
Â  document.getElementById('menuDesc').value='';
Â  document.getElementById('menuPrice').value='';
Â  document.getElementById('menuImage').value='';
}

/* edit / delete delegation */
menuList.addEventListener('click', (ev)=>{
Â  const edit = ev.target.getAttribute('data-edit');
Â  const del = ev.target.getAttribute('data-delete');
Â  if(edit!=null){
Â  Â  const idx = Number(edit);
Â  Â  const it = menu[idx];
Â  Â  // Load data to form
Â  Â  document.getElementById('menuName').value = it.name;
Â  Â  document.getElementById('menuDesc').value = it.desc;
Â  Â  document.getElementById('menuPrice').value = it.price;
Â  Â  document.getElementById('menuImage').value = it.image||'';
Â  Â  // remove original item (so 'Add' button becomes 'Save')
Â  Â  menu.splice(idx,1);
Â  Â  render();
Â  Â  saveMenuToLocal(menu);
Â  } else if(del!=null){
Â  Â  if(confirm('à¸¥à¸šà¸£à¸²à¸¢à¸à¸²à¸£à¹€à¸¡à¸™à¸¹à¸™à¸µà¹‰à¸ˆà¸£à¸´à¸‡à¸«à¸£à¸·à¸­à¹„à¸¡à¹ˆ?')){
Â  Â  Â  menu.splice(Number(del),1);
Â  Â  Â  render();
Â  Â  Â  saveMenuToLocal(menu);
Â  Â  }
Â  }
});

/* save / download / upload */
document.getElementById('saveLocal').addEventListener('click', ()=> {
Â  saveMenuToLocal(menu);
Â  alert('à¸šà¸±à¸™à¸—à¸¶à¸à¸¥à¸‡ localStorage à¹€à¸£à¸µà¸¢à¸šà¸£à¹‰à¸­à¸¢');
});

document.getElementById('downloadJson').addEventListener('click', ()=> {
Â  const blob = new Blob([JSON.stringify(menu, null, 2)], {type:'application/json'});
Â  const url = URL.createObjectURL(blob);
Â  const a = document.createElement('a');
Â  a.href = url; a.download = 'menu.json';
Â  document.body.appendChild(a); a.click();
Â  a.remove(); URL.revokeObjectURL(url);
});

document.getElementById('uploadJson').addEventListener('click', ()=> {
Â  document.getElementById('fileIn').click();
});
document.getElementById('fileIn').addEventListener('change', (e)=>{
Â  const f = e.target.files[0];
Â  if(!f) return;
Â  const r = new FileReader();
Â  r.onload = () => {
Â  Â  try {
Â  Â  Â  const data = JSON.parse(r.result);
Â  Â  Â  if(!Array.isArray(data)) throw new Error('à¹„à¸Ÿà¸¥à¹Œà¸•à¹‰à¸­à¸‡à¹€à¸›à¹‡à¸™ array à¸‚à¸­à¸‡à¹€à¸¡à¸™à¸¹');
Â  Â  Â  if(!confirm(`à¸™à¸³à¹€à¸‚à¹‰à¸² ${data.length} à¸£à¸²à¸¢à¸à¸²à¸£à¹€à¸¡à¸™à¸¹ (à¸ˆà¸°à¹à¸—à¸™à¸—à¸µà¹ˆà¸£à¸²à¸¢à¸à¸²à¸£à¸›à¸±à¸ˆà¸ˆà¸¸à¸šà¸±à¸™) ?`)) return;
Â  Â  Â  menu = data;
Â  Â  Â  saveMenuToLocal(menu);
Â  Â  Â  render();
Â  Â  Â  alert('à¸™à¸³à¹€à¸‚à¹‰à¸²à¹€à¸£à¸µà¸¢à¸šà¸£à¹‰à¸­à¸¢');
Â  Â  } catch(err){ alert('à¹„à¸Ÿà¸¥à¹Œà¹„à¸¡à¹ˆà¸–à¸¹à¸à¸•à¹‰à¸­à¸‡: ' + err.message); }
Â  };
Â  r.readAsText(f);
});

/* =========================
Â  Â OPTIONAL: Push to GitHub (use with caution)
Â  Â ========================= */
async function pushToGithub({owner,repo,path,token,contentObj,commitMsg='Update menu.json from admin'}){
Â  // ... (à¹‚à¸„à¹‰à¸”à¸ªà¸³à¸«à¸£à¸±à¸š Push to Github à¸—à¸µà¹ˆà¸‹à¸±à¸šà¸‹à¹‰à¸­à¸™à¸•à¸²à¸¡à¹‚à¸„à¹‰à¸”à¹€à¸”à¸´à¸¡) ...
Â  const apiBase = 'https://api.github.com';
Â  const getUrl = `${apiBase}/repos/${owner}/${repo}/contents/${encodeURIComponent(path)}`;
Â  // 1) get current file to obtain sha (if exists)
Â  const headers = { Authorization: `token ${token}`, Accept: 'application/vnd.github.v3+json' };
Â  let sha = null;
Â  try {
Â  Â  const res = await fetch(getUrl, {headers});
Â  Â  if(res.status === 200){
Â  Â  Â  const j = await res.json();
Â  Â  Â  sha = j.sha;
Â  Â  } else if(res.status === 404){
Â  Â  Â  sha = null; // new file
Â  Â  } else {
Â  Â  Â  const t = await res.text();
Â  Â  Â  throw new Error('GET file failed: ' + res.status + ' ' + t);
Â  Â  }
Â  } catch(err){ throw err; }

Â  // 2) PUT new content
Â  const contentStr = JSON.stringify(contentObj, null, 2);
Â  const body = {
Â  Â  message: commitMsg,
Â  Â  content: btoa(unescape(encodeURIComponent(contentStr))),
Â  Â  committer: { name: "krualuang-admin", email: "admin@krualuang.local" }
Â  };
Â  if(sha) body.sha = sha;

Â  const putRes = await fetch(getUrl, {
Â  Â  method: 'PUT',
Â  Â  headers,
Â  Â  body: JSON.stringify(body)
Â  });
Â  if(!putRes.ok){
Â  Â  const text = await putRes.text();
Â  Â  throw new Error('PUT failed: ' + putRes.status + ' ' + text);
Â  }
Â  return await putRes.json();
}

document.getElementById('pushGithubBtn').addEventListener('click', async ()=>{
Â  const token = document.getElementById('ghToken').value.trim();
Â  if(!token){ if(!confirm('à¸„à¸¸à¸“à¸¢à¸±à¸‡à¹„à¸¡à¹ˆà¹„à¸”à¹‰à¹ƒà¸ªà¹ˆ GitHub token â€” à¸•à¹‰à¸­à¸‡à¸à¸²à¸£à¸”à¸³à¹€à¸™à¸´à¸™à¸à¸²à¸£à¸•à¹ˆà¸­à¹à¸šà¸š LOCAL (à¸”à¸²à¸§à¸™à¹Œà¹‚à¸«à¸¥à¸” JSON) à¹à¸—à¸™à¸«à¸£à¸·à¸­à¹„à¸¡à¹ˆ?')) return; }

Â  // default values (à¹€à¸›à¸¥à¸µà¹ˆà¸¢à¸™à¹ƒà¸«à¹‰à¸•à¸£à¸‡ repo à¸‚à¸­à¸‡à¸„à¸¸à¸“!)
Â  const owner = 'krualuang';Â  Â  // <-- à¹€à¸›à¸¥à¸µà¹ˆà¸¢à¸™à¹€à¸›à¹‡à¸™ owner à¸‚à¸­à¸‡ repo
Â  const repoÂ  = 'krualuang.github.io'; // <-- à¹€à¸›à¸¥à¸µà¹ˆà¸¢à¸™à¸Šà¸·à¹ˆà¸­ repo
Â  const pathÂ  = 'data/menu.json'; // <-- path à¹ƒà¸™ repo à¸—à¸µà¹ˆà¸•à¹‰à¸­à¸‡à¸à¸²à¸£à¸šà¸±à¸™à¸—à¸¶à¸

Â  if(!token){
Â  Â  // fallback: prompt download
Â  Â  document.getElementById('downloadJson').click();
Â  Â  return;
Â  }

Â  try {
Â  Â  const res = await pushToGithub({owner,repo,path,token,contentObj:menu,commitMsg:'Update menu.json via admin UI'});
Â  Â  alert('Push à¸ªà¸³à¹€à¸£à¹‡à¸ˆ: ' + (res.commit && res.commit.sha ? res.commit.sha : 'OK'));
Â  } catch(err){
Â  Â  alert('Push à¸¥à¹‰à¸¡à¹€à¸«à¸¥à¸§: ' + err.message + '\nà¹à¸™à¸°à¸™à¸³: à¹ƒà¸Šà¹‰ Node script à¸«à¸£à¸·à¸­ GitHub Actions à¸¡à¸²à¸à¸à¸§à¹ˆà¸²à¹ƒà¸ªà¹ˆ token à¹ƒà¸™à¸šà¸£à¸²à¸§à¹Œà¹€à¸‹à¸­à¸£à¹Œ.');
Â  }
});

/* =========================
Â  Â Login handling
Â  Â ========================= */
document.getElementById('btnLogin').addEventListener('click', ()=>{
Â  const v = (document.getElementById('pin').value||'').trim();
Â  if(v === ADMIN_PIN){
Â  Â  document.getElementById('loginWrap').style.display='none';
Â  Â  document.getElementById('adminUI').style.display='block';
Â  Â  render();
Â  } else {
Â  Â  alert('PIN à¸œà¸´à¸” à¸à¸£à¸¸à¸“à¸²à¸¥à¸­à¸‡à¹ƒà¸«à¸¡à¹ˆ');
Â  }
});
document.getElementById('btnUseDemo').addEventListener('click', ()=>{
Â  document.getElementById('loginWrap').style.display='none';
Â  document.getElementById('adminUI').style.display='block';
Â  render();
});

/* Initial render (if already logged via demo) */
if(menu && menu.length) {
Â  // don't auto-show admin; require login
}
</script>

<script src="js/menu-generator.js"></script>

</body>
</html>
